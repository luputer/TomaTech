{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":1,"column":0},"end":{"line":211,"column":36}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"../vendor/emitter/EventEmitter","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":13,"column":0},"end":{"line":13,"column":58}}],"key":"fgDwi/IrVIcBdLV47qHthWsoTIw="}},{"name":"../BatchedBridge/BatchedBridge","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":15,"column":22},"end":{"line":15,"column":63}}],"key":"MvuFHLrr66uWZvuv+I/rfsDBNt0="}},{"name":"../Utilities/infoLog","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":16,"column":16},"end":{"line":16,"column":47}}],"key":"te7FMDljSHoh4Ptoq0ebhkaWbSA="}},{"name":"./TaskQueue","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":17,"column":18},"end":{"line":17,"column":40}}],"key":"1ceiWyFBQZw9eNp9+Dpb/TWmHXc="}},{"name":"invariant","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":18,"column":18},"end":{"line":18,"column":38}}],"key":"Fzi/BpZws2YooIGJ9b6u0HJtuks="}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  var _EventEmitter = _interopRequireDefault(require(_dependencyMap[1], \"../vendor/emitter/EventEmitter\"));\n  var BatchedBridge = require(_dependencyMap[2], \"../BatchedBridge/BatchedBridge\");\n  var infoLog = require(_dependencyMap[3], \"../Utilities/infoLog\");\n  var TaskQueue = require(_dependencyMap[4], \"./TaskQueue\");\n  var invariant = require(_dependencyMap[5], \"invariant\");\n  var _emitter = new _EventEmitter.default();\n  var DEBUG_DELAY = 0;\n  var DEBUG = false;\n  var InteractionManager = {\n    Events: {\n      interactionStart: 'interactionStart',\n      interactionComplete: 'interactionComplete'\n    },\n    runAfterInteractions(task) {\n      var tasks = [];\n      var promise = new Promise(resolve => {\n        _scheduleUpdate();\n        if (task) {\n          tasks.push(task);\n        }\n        tasks.push({\n          run: resolve,\n          name: 'resolve ' + (task && task.name || '?')\n        });\n        _taskQueue.enqueueTasks(tasks);\n      });\n      return {\n        then: promise.then.bind(promise),\n        cancel: function () {\n          _taskQueue.cancelTasks(tasks);\n        }\n      };\n    },\n    createInteractionHandle() {\n      DEBUG && infoLog('InteractionManager: create interaction handle');\n      _scheduleUpdate();\n      var handle = ++_inc;\n      _addInteractionSet.add(handle);\n      return handle;\n    },\n    clearInteractionHandle(handle) {\n      DEBUG && infoLog('InteractionManager: clear interaction handle');\n      invariant(!!handle, 'InteractionManager: Must provide a handle to clear.');\n      _scheduleUpdate();\n      _addInteractionSet.delete(handle);\n      _deleteInteractionSet.add(handle);\n    },\n    addListener: _emitter.addListener.bind(_emitter),\n    setDeadline(deadline) {\n      _deadline = deadline;\n    }\n  };\n  var _interactionSet = new Set();\n  var _addInteractionSet = new Set();\n  var _deleteInteractionSet = new Set();\n  var _taskQueue = new TaskQueue({\n    onMoreTasks: _scheduleUpdate\n  });\n  var _nextUpdateHandle = 0;\n  var _inc = 0;\n  var _deadline = -1;\n  function _scheduleUpdate() {\n    if (!_nextUpdateHandle) {\n      if (_deadline > 0) {\n        _nextUpdateHandle = setTimeout(_processUpdate, 0 + DEBUG_DELAY);\n      } else {\n        _nextUpdateHandle = setImmediate(_processUpdate);\n      }\n    }\n  }\n  function _processUpdate() {\n    _nextUpdateHandle = 0;\n    var interactionCount = _interactionSet.size;\n    _addInteractionSet.forEach(handle => _interactionSet.add(handle));\n    _deleteInteractionSet.forEach(handle => _interactionSet.delete(handle));\n    var nextInteractionCount = _interactionSet.size;\n    if (interactionCount !== 0 && nextInteractionCount === 0) {\n      _emitter.emit(InteractionManager.Events.interactionComplete);\n    } else if (interactionCount === 0 && nextInteractionCount !== 0) {\n      _emitter.emit(InteractionManager.Events.interactionStart);\n    }\n    if (nextInteractionCount === 0) {\n      while (_taskQueue.hasTasksToProcess()) {\n        _taskQueue.processNext();\n        if (_deadline > 0 && BatchedBridge.getEventLoopRunningTime() >= _deadline) {\n          _scheduleUpdate();\n          break;\n        }\n      }\n    }\n    _addInteractionSet.clear();\n    _deleteInteractionSet.clear();\n  }\n  module.exports = InteractionManager;\n});","lineCount":97,"map":[[3,2,13,0],[3,6,13,0,"_EventEmitter"],[3,19,13,0],[3,22,13,0,"_interopRequireDefault"],[3,44,13,0],[3,45,13,0,"require"],[3,52,13,0],[3,53,13,0,"_dependencyMap"],[3,67,13,0],[4,2,15,0],[4,6,15,6,"BatchedBridge"],[4,19,15,19],[4,22,15,22,"require"],[4,29,15,29],[4,30,15,29,"_dependencyMap"],[4,44,15,29],[4,81,15,62],[4,82,15,63],[5,2,16,0],[5,6,16,6,"infoLog"],[5,13,16,13],[5,16,16,16,"require"],[5,23,16,23],[5,24,16,23,"_dependencyMap"],[5,38,16,23],[5,65,16,46],[5,66,16,47],[6,2,17,0],[6,6,17,6,"TaskQueue"],[6,15,17,15],[6,18,17,18,"require"],[6,25,17,25],[6,26,17,25,"_dependencyMap"],[6,40,17,25],[6,58,17,39],[6,59,17,40],[7,2,18,0],[7,6,18,6,"invariant"],[7,15,18,15],[7,18,18,18,"require"],[7,25,18,25],[7,26,18,25,"_dependencyMap"],[7,40,18,25],[7,56,18,37],[7,57,18,38],[8,2,22,0],[8,6,22,6,"_emitter"],[8,14,22,14],[8,17,22,17],[8,21,22,21,"EventEmitter"],[8,42,22,33],[8,43,25,3],[8,44,25,4],[9,2,27,0],[9,6,27,6,"DEBUG_DELAY"],[9,17,27,20],[9,20,27,23],[9,21,27,24],[10,2,28,0],[10,6,28,6,"DEBUG"],[10,11,28,18],[10,14,28,21],[10,19,28,26],[11,2,79,0],[11,6,79,6,"InteractionManager"],[11,24,79,24],[11,27,79,27],[12,4,80,2,"Events"],[12,10,80,8],[12,12,80,10],[13,6,81,4,"interactionStart"],[13,22,81,20],[13,24,81,22],[13,42,81,40],[14,6,82,4,"interactionComplete"],[14,25,82,23],[14,27,82,25],[15,4,83,2],[15,5,83,3],[16,4,89,2,"runAfterInteractions"],[16,24,89,22,"runAfterInteractions"],[16,25,89,23,"task"],[16,29,89,34],[16,31,96,4],[17,6,97,4],[17,10,97,10,"tasks"],[17,15,97,28],[17,18,97,31],[17,20,97,33],[18,6,98,4],[18,10,98,10,"promise"],[18,17,98,17],[18,20,98,20],[18,24,98,24,"Promise"],[18,31,98,31],[18,32,98,33,"resolve"],[18,39,98,52],[18,43,98,57],[19,8,99,6,"_scheduleUpdate"],[19,23,99,21],[19,24,99,22],[19,25,99,23],[20,8,100,6],[20,12,100,10,"task"],[20,16,100,14],[20,18,100,16],[21,10,101,8,"tasks"],[21,15,101,13],[21,16,101,14,"push"],[21,20,101,18],[21,21,101,19,"task"],[21,25,101,23],[21,26,101,24],[22,8,102,6],[23,8,103,6,"tasks"],[23,13,103,11],[23,14,103,12,"push"],[23,18,103,16],[23,19,103,17],[24,10,104,8,"run"],[24,13,104,11],[24,15,104,13,"resolve"],[24,22,104,20],[25,10,105,8,"name"],[25,14,105,12],[25,16,105,14],[25,26,105,24],[25,30,105,29,"task"],[25,34,105,33],[25,38,105,37,"task"],[25,42,105,41],[25,43,105,42,"name"],[25,47,105,46],[25,51,105,51],[25,54,105,54],[26,8,106,6],[26,9,106,7],[26,10,106,8],[27,8,107,6,"_taskQueue"],[27,18,107,16],[27,19,107,17,"enqueueTasks"],[27,31,107,29],[27,32,107,30,"tasks"],[27,37,107,35],[27,38,107,36],[28,6,108,4],[28,7,108,5],[28,8,108,6],[29,6,109,4],[29,13,109,11],[30,8,111,6,"then"],[30,12,111,10],[30,14,111,12,"promise"],[30,21,111,19],[30,22,111,20,"then"],[30,26,111,24],[30,27,111,25,"bind"],[30,31,111,29],[30,32,111,30,"promise"],[30,39,111,37],[30,40,111,38],[31,8,112,6,"cancel"],[31,14,112,12],[31,16,112,14],[31,25,112,14,"cancel"],[31,26,112,14],[31,28,112,26],[32,10,113,8,"_taskQueue"],[32,20,113,18],[32,21,113,19,"cancelTasks"],[32,32,113,30],[32,33,113,31,"tasks"],[32,38,113,36],[32,39,113,37],[33,8,114,6],[34,6,115,4],[34,7,115,5],[35,4,116,2],[35,5,116,3],[36,4,121,2,"createInteractionHandle"],[36,27,121,25,"createInteractionHandle"],[36,28,121,25],[36,30,121,36],[37,6,122,4,"DEBUG"],[37,11,122,9],[37,15,122,13,"infoLog"],[37,22,122,20],[37,23,122,21],[37,70,122,68],[37,71,122,69],[38,6,123,4,"_scheduleUpdate"],[38,21,123,19],[38,22,123,20],[38,23,123,21],[39,6,124,4],[39,10,124,10,"handle"],[39,16,124,16],[39,19,124,19],[39,21,124,21,"_inc"],[39,25,124,25],[40,6,125,4,"_addInteractionSet"],[40,24,125,22],[40,25,125,23,"add"],[40,28,125,26],[40,29,125,27,"handle"],[40,35,125,33],[40,36,125,34],[41,6,126,4],[41,13,126,11,"handle"],[41,19,126,17],[42,4,127,2],[42,5,127,3],[43,4,132,2,"clearInteractionHandle"],[43,26,132,24,"clearInteractionHandle"],[43,27,132,25,"handle"],[43,33,132,39],[43,35,132,41],[44,6,133,4,"DEBUG"],[44,11,133,9],[44,15,133,13,"infoLog"],[44,22,133,20],[44,23,133,21],[44,69,133,67],[44,70,133,68],[45,6,134,4,"invariant"],[45,15,134,13],[45,16,134,14],[45,17,134,15],[45,18,134,16,"handle"],[45,24,134,22],[45,26,134,24],[45,79,134,77],[45,80,134,78],[46,6,135,4,"_scheduleUpdate"],[46,21,135,19],[46,22,135,20],[46,23,135,21],[47,6,136,4,"_addInteractionSet"],[47,24,136,22],[47,25,136,23,"delete"],[47,31,136,29],[47,32,136,30,"handle"],[47,38,136,36],[47,39,136,37],[48,6,137,4,"_deleteInteractionSet"],[48,27,137,25],[48,28,137,26,"add"],[48,31,137,29],[48,32,137,30,"handle"],[48,38,137,36],[48,39,137,37],[49,4,138,2],[49,5,138,3],[50,4,141,2,"addListener"],[50,15,141,13],[50,17,141,16,"_emitter"],[50,25,141,24],[50,26,141,25,"addListener"],[50,37,141,36],[50,38,141,37,"bind"],[50,42,141,41],[50,43,141,42,"_emitter"],[50,51,141,50],[50,52,141,64],[51,4,148,2,"setDeadline"],[51,15,148,13,"setDeadline"],[51,16,148,14,"deadline"],[51,24,148,30],[51,26,148,32],[52,6,149,4,"_deadline"],[52,15,149,13],[52,18,149,16,"deadline"],[52,26,149,24],[53,4,150,2],[54,2,151,0],[54,3,151,1],[55,2,153,0],[55,6,153,6,"_interactionSet"],[55,21,153,21],[55,24,153,24],[55,28,153,28,"Set"],[55,31,153,31],[55,32,153,49],[55,33,153,50],[56,2,154,0],[56,6,154,6,"_addInteractionSet"],[56,24,154,24],[56,27,154,27],[56,31,154,31,"Set"],[56,34,154,34],[56,35,154,52],[56,36,154,53],[57,2,155,0],[57,6,155,6,"_deleteInteractionSet"],[57,27,155,27],[57,30,155,30],[57,34,155,34,"Set"],[57,37,155,37],[57,38,155,46],[57,39,155,47],[58,2,156,0],[58,6,156,6,"_taskQueue"],[58,16,156,16],[58,19,156,19],[58,23,156,23,"TaskQueue"],[58,32,156,32],[58,33,156,33],[59,4,156,34,"onMoreTasks"],[59,15,156,45],[59,17,156,47,"_scheduleUpdate"],[60,2,156,62],[60,3,156,63],[60,4,156,64],[61,2,157,0],[61,6,157,4,"_nextUpdateHandle"],[61,23,157,45],[61,26,157,48],[61,27,157,49],[62,2,158,0],[62,6,158,4,"_inc"],[62,10,158,8],[62,13,158,11],[62,14,158,12],[63,2,159,0],[63,6,159,4,"_deadline"],[63,15,159,13],[63,18,159,16],[63,19,159,17],[63,20,159,18],[64,2,164,0],[64,11,164,9,"_scheduleUpdate"],[64,26,164,24,"_scheduleUpdate"],[64,27,164,24],[64,29,164,27],[65,4,165,2],[65,8,165,6],[65,9,165,7,"_nextUpdateHandle"],[65,26,165,24],[65,28,165,26],[66,6,166,4],[66,10,166,8,"_deadline"],[66,19,166,17],[66,22,166,20],[66,23,166,21],[66,25,166,23],[67,8,167,6,"_nextUpdateHandle"],[67,25,167,23],[67,28,167,26,"setTimeout"],[67,38,167,36],[67,39,167,37,"_processUpdate"],[67,53,167,51],[67,55,167,53],[67,56,167,54],[67,59,167,57,"DEBUG_DELAY"],[67,70,167,68],[67,71,167,69],[68,6,168,4],[68,7,168,5],[68,13,168,11],[69,8,169,6,"_nextUpdateHandle"],[69,25,169,23],[69,28,169,26,"setImmediate"],[69,40,169,38],[69,41,169,39,"_processUpdate"],[69,55,169,53],[69,56,169,54],[70,6,170,4],[71,4,171,2],[72,2,172,0],[73,2,177,0],[73,11,177,9,"_processUpdate"],[73,25,177,23,"_processUpdate"],[73,26,177,23],[73,28,177,26],[74,4,178,2,"_nextUpdateHandle"],[74,21,178,19],[74,24,178,22],[74,25,178,23],[75,4,180,2],[75,8,180,8,"interactionCount"],[75,24,180,24],[75,27,180,27,"_interactionSet"],[75,42,180,42],[75,43,180,43,"size"],[75,47,180,47],[76,4,181,2,"_addInteractionSet"],[76,22,181,20],[76,23,181,21,"forEach"],[76,30,181,28],[76,31,181,29,"handle"],[76,37,181,35],[76,41,181,39,"_interactionSet"],[76,56,181,54],[76,57,181,55,"add"],[76,60,181,58],[76,61,181,59,"handle"],[76,67,181,65],[76,68,181,66],[76,69,181,67],[77,4,182,2,"_deleteInteractionSet"],[77,25,182,23],[77,26,182,24,"forEach"],[77,33,182,31],[77,34,182,32,"handle"],[77,40,182,38],[77,44,182,42,"_interactionSet"],[77,59,182,57],[77,60,182,58,"delete"],[77,66,182,64],[77,67,182,65,"handle"],[77,73,182,71],[77,74,182,72],[77,75,182,73],[78,4,183,2],[78,8,183,8,"nextInteractionCount"],[78,28,183,28],[78,31,183,31,"_interactionSet"],[78,46,183,46],[78,47,183,47,"size"],[78,51,183,51],[79,4,185,2],[79,8,185,6,"interactionCount"],[79,24,185,22],[79,29,185,27],[79,30,185,28],[79,34,185,32,"nextInteractionCount"],[79,54,185,52],[79,59,185,57],[79,60,185,58],[79,62,185,60],[80,6,187,4,"_emitter"],[80,14,187,12],[80,15,187,13,"emit"],[80,19,187,17],[80,20,187,18,"InteractionManager"],[80,38,187,36],[80,39,187,37,"Events"],[80,45,187,43],[80,46,187,44,"interactionComplete"],[80,65,187,63],[80,66,187,64],[81,4,188,2],[81,5,188,3],[81,11,188,9],[81,15,188,13,"interactionCount"],[81,31,188,29],[81,36,188,34],[81,37,188,35],[81,41,188,39,"nextInteractionCount"],[81,61,188,59],[81,66,188,64],[81,67,188,65],[81,69,188,67],[82,6,190,4,"_emitter"],[82,14,190,12],[82,15,190,13,"emit"],[82,19,190,17],[82,20,190,18,"InteractionManager"],[82,38,190,36],[82,39,190,37,"Events"],[82,45,190,43],[82,46,190,44,"interactionStart"],[82,62,190,60],[82,63,190,61],[83,4,191,2],[84,4,194,2],[84,8,194,6,"nextInteractionCount"],[84,28,194,26],[84,33,194,31],[84,34,194,32],[84,36,194,34],[85,6,195,4],[85,13,195,11,"_taskQueue"],[85,23,195,21],[85,24,195,22,"hasTasksToProcess"],[85,41,195,39],[85,42,195,40],[85,43,195,41],[85,45,195,43],[86,8,196,6,"_taskQueue"],[86,18,196,16],[86,19,196,17,"processNext"],[86,30,196,28],[86,31,196,29],[86,32,196,30],[87,8,197,6],[87,12,198,8,"_deadline"],[87,21,198,17],[87,24,198,20],[87,25,198,21],[87,29,199,8,"BatchedBridge"],[87,42,199,21],[87,43,199,22,"getEventLoopRunningTime"],[87,66,199,45],[87,67,199,46],[87,68,199,47],[87,72,199,51,"_deadline"],[87,81,199,60],[87,83,200,8],[88,10,202,8,"_scheduleUpdate"],[88,25,202,23],[88,26,202,24],[88,27,202,25],[89,10,203,8],[90,8,204,6],[91,6,205,4],[92,4,206,2],[93,4,207,2,"_addInteractionSet"],[93,22,207,20],[93,23,207,21,"clear"],[93,28,207,26],[93,29,207,27],[93,30,207,28],[94,4,208,2,"_deleteInteractionSet"],[94,25,208,23],[94,26,208,24,"clear"],[94,31,208,29],[94,32,208,30],[94,33,208,31],[95,2,209,0],[96,2,211,0,"module"],[96,8,211,6],[96,9,211,7,"exports"],[96,16,211,14],[96,19,211,17,"InteractionManager"],[96,37,211,35],[97,0,211,36],[97,3]],"functionMap":{"names":["<global>","runAfterInteractions","Promise$argument_0","cancel","createInteractionHandle","clearInteractionHandle","setDeadline","_scheduleUpdate","_processUpdate","_addInteractionSet.forEach$argument_0","_deleteInteractionSet.forEach$argument_0"],"mappings":"AAA;ECwF;gCCS;KDU;cEI;OFE;GDE;EIK;GJM;EKK;GLM;EMU;GNE;AOc;CPQ;AQK;6BCI,qCD;gCEC,wCF;CR2B"}},"type":"js/module"}]}